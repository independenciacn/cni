function busca_cliente(){var e=$F("cliente"),a="datos.php",t="opcion=1&texto="+e;new Ajax.Request(a,{method:"post",parameters:t,onComplete:function(e){$("listado_clientes").innerHTML=e.responseText}})}function marca(e){var a="datos.php",t="opcion=2&cliente="+e;new Ajax.Request(a,{method:"post",parameters:t,onComplete:function(e){var a=new String(e.responseText),t=a.split(";");$("id_cliente").value=t[0],$("cliente").value=t[1],$("listado_clientes").innerHTML=""},onSuccess:ver_servicios_contratados(e)})}function ver_servicios_contratados(e){var a="datos.php";if(null==e)var e=$F("id_cliente");var t=$("meses").value,o="opcion=3&cliente="+e+"&mes="+t+"&anyo="+$("anyo").value;new Ajax.Request(a,{method:"post",parameters:o,onComplete:function(e){$("tabla").innerHTML=e.responseText}})}function borra(e){var a=confirm("Borrar servicio?");if(1==a){var t="datos.php",o="opcion=4&servicio="+e;new Ajax.Request(t,{method:"post",parameters:o,onComplete:precarga})}}function modificar(e){var a=$("modificar").style;a.visibility="visible",a.display="block";var t="datos.php",o="opcion=5&servicio="+e;new Ajax.Request(t,{method:"post",parameters:o,onComplete:function(e){$("modificar").innerHTML=e.responseText}})}function modif(e){var a="datos.php",t=$("modificacion"),o="opcion=6&servicio="+e+"&"+Form.serialize(t);new Ajax.Request(a,{method:"post",parameters:o,onComplete:function(e){precarga(),$("debug").innerHTML=e.responseText}})}function cierra_frm_modificacion(){var e=$("modificar").style;e.visibility="hidden",e.display="none",$("modificar").innerHTML=""}function recalcula_modificacion(){iva=$F("iva"),cantidad=$F("cantidad"),precio=$F("precio"),importe=eval(precio)*eval(cantidad),total=eval(importe)+eval(importe)*eval(iva)/100,original=parseFloat(total),result=Math.round(100*original)/100,originala=parseFloat(importe),resulta=Math.round(100*originala)/100,$("total").innerHTML=result,$("importe").innerHTML=resulta}function ver_frm_agregar_servicio(e){var a="datos.php",t="opcion=7&cliente="+e;new Ajax.Request(a,{method:"post",parameters:t,onComplete:function(e){$("form_agregar").innerHTML=e.responseText}})}function dame_el_valor(){var e="datos.php",a=$("servicios").value,t="opcion=8&servicio="+a;new Ajax.Request(e,{method:"post",parameters:t,onComplete:function(e){var a=new String(e.responseText),t=a.split(";");$("precio").value=t[0],$("iva").value=t[1],recalcula()}})}function recalcula(){iva=$F("iva"),cantidad=$F("cantidad"),precio=$F("precio"),importe=eval(precio)*eval(cantidad),total=eval(importe)+eval(importe)*eval(iva)/100,original=parseFloat(total),result=Math.round(100*original)/100,originala=parseFloat(importe),resulta=Math.round(100*originala)/100,$("total").innerHTML=result,$("importe").innerHTML=resulta}function agrega_servicio(){var e="datos.php",a=$F("id_cliente"),t=$("frm_alta"),o="opcion=9&cliente="+a+"&"+Form.serialize(t);new Ajax.Request(e,{method:"post",parameters:o,onComplete:function(e){precarga(),$("debug").innerHTML=e.responseText}})}function precarga(){var e;$("tabla").innerHTML='Actualizando Datos ... <p/><img src="../imagenes/loader.gif" alt="Actualizando Datos.." />',e=setTimeout("ver_servicios_contratados()",1)}function observaciones(e){var a="datos.php",t="opcion=10&servicio="+e,o=$("observa").style;o.display="block",o.visibility="visible";new Ajax.Request(a,{method:"post",parameters:t,onComplete:function(e){$("observa").innerHTML=e.responseText}})}function cierra_ventana_observaciones(){var e=$("observa").style;e.display="none",e.visibility="hidden"}function genera_factura(e){var a=$F("id_cliente"),t=$("meses").value,o=$F("fecha_factura"),n=encodeURI($F("observaciones")),e=$F("codigo");if(1==$F("tipo"))var i=$F("fecha_inicial_factura"),r=$F("fecha_final_factura");else var i="0000-00-00",r="0000-00-00";if(0!=a||0!=t){var c="genfactura.php?mes="+t+"&cliente="+a+"&fecha_factura="+o+"&codigo="+e+"&fecha_inicial_factura="+i+"&fecha_final_factura="+r+"&observaciones="+n;window.open(c)}else alert("Debe seleccionar un cliente y Mes")}function genera_factura_prueba(e){var a=$F("id_cliente"),t=$("meses").value,o=$F("fecha_factura"),n=encodeURI($F("observaciones")),e=$F("codigo");if(1==$F("tipo"))var i=$F("fecha_inicial_factura"),r=$F("fecha_final_factura");else var i="0000-00-00",r="0000-00-00";if(0!=a||0!=t){var c="genfactura.php?mes="+t+"&cliente="+a+"&fecha_factura="+o+"&codigo="+e+"&fecha_inicial_factura="+i+"&fecha_final_factura="+r+"&observaciones="+n+"&prueba=1";window.open(c),cliente_rango(0)}else alert("Debe seleccionar un cliente y Mes")}function generar_excel(){var e=$F("id_cliente"),a=$("meses").value,t=$("anyo").value,o=$F("fecha_factura"),n=$F("codigo");if(1==$F("tipo"))var i=$F("fecha_inicial_factura"),r=$F("fecha_final_factura");else var i="foo",r="foo";if(0!=e||0!=a){var c="excel.php?anyo="+t+"&mes="+a+"&cliente="+e+"&fecha_factura="+o+"&codigo="+n+"&fecha_inicial_factura="+i+"&fecha_final_factura="+r;window.open(c,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes")}else alert("Debe seleccionar un cliente y Mes")}function gestion_facturas(tipo){var url="datos.php",pars;if(tipo=eval(tipo),1==tipo)pars="opcion=11&tipo=1";else{var cliente=$F("id_cliente"),mes=$("meses").value;pars="opcion=11&cliente="+cliente+"&mes="+mes+"&tipo=0"}var estilo=$("tabla").style;estilo.display="block",estilo.visibility="visible";var myAjax=new Ajax.Request(url,{method:"post",parameters:pars,onComplete:function(e){$("tabla").innerHTML=e.responseText}})}function listado_facturas(){var e="datos.php",a=$F("id_cliente"),t=$("meses").value,o="opcion=12&cliente="+a+"&mes="+t;new Ajax.Request(e,{method:"post",parameters:o,onComplete:function(e){$("facturacion").innerHTML=e.responseText}})}function borrar_factura(e){var a="datos.php",t=$F("id_cliente"),o=$("meses").value,n="opcion=13&cliente="+t+"&mes="+o+"&factura="+e;new Ajax.Request(a,{method:"post",parameters:n,onComplete:listado_facturas()})}function ver_factura(e){var a="genfactura.php?factura="+e;window.open(a)}function duplicado_factura(e){var a="genfactura.php?duplicado="+e;window.open(a)}function genera_recibo(e){var a="genrecibo.php?id="+e;window.open(a)}function cliente_rango(e){var a="nufact.php",t=$F("id_cliente"),o="opcion="+e+"&cliente="+t;new Ajax.Request(a,{method:"post",parameters:o,onComplete:function(a){$("parametros_facturacion").innerHTML=a.responseText,campos_fecha(e)}})}function campos_fecha(e){1==e&&(Calendar.setup({inputField:"fecha_inicial_factura",ifFormat:"%d-%m-%Y",showsTime:!0,button:"f_trigger_fecha_inicial_factura",singleClick:!1,step:1}),Calendar.setup({inputField:"fecha_final_factura",ifFormat:"%d-%m-%Y",showsTime:!0,button:"f_trigger_fecha_final_factura",singleClick:!1,step:1})),Calendar.setup({inputField:"fecha_factura",ifFormat:"%d-%m-%Y",showsTime:!0,button:"f_trigger_fecha_factura",singleClick:!1,step:1})}function oculta_parametros(){$("parametros_facturacion").innerHTML=""}function cambia_color(e){var a=$("linea_"+e).style;a.backgroundColor="#00FF00"}function quitar_color(e){var a=$("linea_"+e).style;a.backgroundColor=""}function sort(e,a,t){var o="datos.php",n="opcion=11&seccion="+e+"&valor="+a+"&tipo="+t;new Ajax.Request(o,{method:"post",parameters:n,onComplete:function(e){$("tabla_resultados").innerHTML=e.responseText},onCreate:$("tabla_resultados").innerHTML="Cargando...<p/><img src='loader.gif' alt='Cargando...'/>"})}function filtro(e){var a=!1,t="datos.php",o=$F("filtro_"+e),n="opcion=14&filtro="+e+"&texto="+o;if(2==e?o.length>=10&&(a=!0):o.length>=3&&(a=!0),a){new Ajax.Request(t,{method:"post",parameters:n,onComplete:function(e){$("tabla_resultados").innerHTML=e.responseText},onCreate:$("tabla_resultados").innerHTML="Cargando...<p/><img src='loader.gif' alt='Cargando...'/>"})}}function sort(e){var a="datos.php",t=$F("marca_cliente"),o=$F("marca_factura"),n=$F("marca_fecha"),i=$F("marca_importe"),r="opcion=15&seccion="+e+"&marca_cliente="+t+"&marca_factura="+o+"&marca_fecha="+n+"&marca_importe="+i;new Ajax.Request(a,{method:"post",parameters:r,onComplete:function(e){$("tabla_resultados").innerHTML=e.responseText},onCreate:$("tabla_resultados").innerHTML="Cargando...<p/><img src='loader.gif' alt='Cargando...'/>"})}function guarda_check_pdf(e){if(1==e)var a="&dup=1";else var a="";var t=document.getElementsByName("code"),o=(new Array,"");for(z=0;z<t.length;z++)if(t[z].checked){var n="facturapdf.php";o=o+"<br>Generada Factura "+t[z].value;new Ajax.Request(n,{method:"post",parameters:"factura="+t[z].value+a,onComplete:function(e){$("linea_generacion").innerHTML=o}})}}function check_all(){var e=document.getElementsByName("code");for(z=0;z<e.length;z++)0==e[z].checked&&(e[z].checked=!0)}function uncheck_all(){var e=document.getElementsByName("code");for(z=0;z<e.length;z++)1==e[z].checked&&(e[z].checked=!1)}function envia_check_pdf(e){var a=document.getElementsByName("code");new Array;for(z=0;z<a.length;z++)if(a[z].checked){setTimeout("envia_la_factura("+a[z].value+","+e+")",5e3)}}function envia_la_factura(e,a){if(1==a)var t="&dup=1";else var t="";var o="facturapdf.php",n=$("linea_generacion").linea=n+"<br /><b>Enviada Factura "+e+" - Envio Completado</b>";new Ajax.Request(o,{method:"post",parameters:"factura="+e+"&envio=1"+t,onComplete:function(e){$("linea_generacion").innerHTML=n}})}